<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>8. Tabula Muris Cluster Benchmarking (Figure 2, S11-S16, S37) • recallreproducibility</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="8. Tabula Muris Cluster Benchmarking (Figure 2, S11-S16, S37)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">recallreproducibility</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01_figure1b-e.html">1. Clustering Simple Simulated Data (Figure 1)</a></li>
    <li><a class="dropdown-item" href="../articles/02_simulations.html">2. Clustering Simulated Data (Figure 1)</a></li>
    <li><a class="dropdown-item" href="../articles/03_figure1f_S2-8.html">UNKNOWN TITLE</a></li>
    <li><a class="dropdown-item" href="../articles/06_cluster-tabula-muris.html">6. Clustering Tabula Muris Tissues</a></li>
    <li><a class="dropdown-item" href="../articles/08_figure2_S11-16_S37.html">8. Tabula Muris Cluster Benchmarking (Figure 2, S11-S16, S37)</a></li>
    <li><a class="dropdown-item" href="../articles/09_figure3.html">9. Figure 3</a></li>
    <li><a class="dropdown-item" href="../articles/10_tissue_umaps.html">10. Plotting Tabula Muris UMAPs (Supplemental Figures S17-S36)</a></li>
    <li><a class="dropdown-item" href="../articles/11_tabula_muris_rare_cell_types.html">11. Marker Gene Method Comparison (Supplemental Figure S38)</a></li>
    <li><a class="dropdown-item" href="../articles/12_S39_DE_comparison.html">12. Marker Gene Method Comparison (Supplemental Figure S39)</a></li>
    <li><a class="dropdown-item" href="../articles/13_multi-dataset-timing.html">13. Benchmarking Runtime and Peak Memory Usage on Multiple Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/14_seurat_data_and_liver_timing.html">14. Plotting Runtime and Peak Memory Usage for Multiple Tissues (Supplemental Figures S26 and S27)</a></li>
    <li><a class="dropdown-item" href="../articles/15_pbmc-timing.html">15. Benchmarking Runtime and Peak Memory Usage on PBMC Subsets</a></li>
    <li><a class="dropdown-item" href="../articles/16_pbmc-timing-plotting.html">16. Plotting Runtime and Peak Memory Usage on PBMC Subsets (Supplemental Figures S42 and S43)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>8. Tabula Muris Cluster Benchmarking (Figure 2, S11-S16, S37)</h1>
            
      

      <div class="d-none name"><code>08_figure2_S11-16_S37.Rmd</code></div>
    </div>

    
    
<p>clustering_metrics_facet_plot_with_additions &lt;- function
(cluster_metrics_df, statistic, y_label) { # remove underscores from
tissue names cluster_metrics_df<span class="math inline">$tissue_name
&lt;- gsub("_", "\n", cluster_metrics_df$</span>tissue_name)</p>
<p># re-order factor levels
cluster_metrics_df<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>e</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>d</mi><mo>&lt;</mo><mo>−</mo><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mi>l</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>e</mi><msub><mi>r</mi><mi>m</mi></msub><mi>e</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>c</mi><msub><mi>s</mi><mi>d</mi></msub><mi>f</mi></mrow><annotation encoding="application/x-tex">method &lt;- factor(cluster_metrics_df</annotation></semantics></math>method,
levels = c(“callback”, “callback_NB”, “callback_Poisson-copula”,
“callback_NB-copula”, “callback_countsplit”, “sc-SHC”, “CHOIR”,
“scace_cluster”))</p>
<p>small_text_size &lt;- 16 large_text_size &lt;- 22</p>
<p>bar_plot &lt;- ggplot2::ggplot(cluster_metrics_df, ggplot2::aes(x =
method, y = !!rlang::sym(statistic), fill = method,
#label=sprintf(“%0.3f”, round(!!rlang::sym(statistic), digits = 3)))) +
label=sprintf(“%0.2f”, round(!!rlang::sym(statistic), digits = 2)))) +
ggplot2::geom_bar( stat = “identity”, position = “dodge”, color =
“black”, alpha = 0.7) + ggplot2::facet_wrap(~tissue_name, ncol = 4) +
ggplot2::scale_y_continuous(breaks=c(0, 0.5, 1.00), limits = c(-0.05,
1.1)) + ggplot2::xlab(“Tabula Muris Tissues”) + ggplot2::ylab(y_label) +
ggplot2::ggtitle(y_label) + ggplot2::labs(fill = “Method”) +
#ggplot2::scale_fill_brewer(palette = “Set1”, labels = c(“callback”,
“sc-SHC”, “CHOIR”)) + ggplot2::scale_fill_manual(values = c(“red”,
“darkmagenta”, “darkgreen”, “deepskyblue2”, “darkorange1”, “grey”,
“black”, “tan”), labels = c(“recall+ZIP”, “recall+NB”,
“recall+Poisson-copula”, “recall+NB-copula”, “recall+countsplit”,
“sc-SHC”, “CHOIR”, “scACE”)) + ggplot2::theme_bw() +
ggplot2::theme(axis.ticks.x = ggplot2::element_blank(), axis.text.x =
ggplot2::element_blank(), axis.text = ggplot2::element_text(size =
small_text_size), axis.title = ggplot2::element_text(size =
large_text_size), strip.text = ggplot2::element_text(size =
small_text_size), legend.text = ggplot2::element_text(size =
small_text_size, family = “Courier”), legend.title =
ggplot2::element_text(size = small_text_size), plot.title =
ggplot2::element_text(size = large_text_size, hjust = 0.5),
legend.position=“bottom”) + ggplot2::geom_text(vjust = -0.2)</p>
<p>return(bar_plot) }</p>
<p>clustering_metrics_facet_plot_for_figure2 &lt;- function
(cluster_metrics_df, statistic, y_label) { # remove underscores from
tissue names cluster_metrics_df<span class="math inline">$tissue_name
&lt;- gsub("_", "\n", cluster_metrics_df$</span>tissue_name)</p>
<p># re-order factor levels
cluster_metrics_df<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>e</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>d</mi><mo>&lt;</mo><mo>−</mo><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mi>l</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>e</mi><msub><mi>r</mi><mi>m</mi></msub><mi>e</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>c</mi><msub><mi>s</mi><mi>d</mi></msub><mi>f</mi></mrow><annotation encoding="application/x-tex">method &lt;- factor(cluster_metrics_df</annotation></semantics></math>method,
levels = c(“callback”, “callback_NB”, “callback_Poisson-copula”,
“callback_NB-copula”, “callback_countsplit”, “sc-SHC”, “CHOIR”,
“scace_cluster”))</p>
<p>cluster_metrics_df &lt;- subset(cluster_metrics_df, method %in%
c(“callback”, “sc-SHC”, “CHOIR”, “scace_cluster”))</p>
<p>small_text_size &lt;- 16 large_text_size &lt;- 22</p>
<p>bar_plot &lt;- ggplot2::ggplot(cluster_metrics_df, ggplot2::aes(x =
method, y = !!rlang::sym(statistic), fill = method,
label=sprintf(“%0.3f”, round(!!rlang::sym(statistic), digits = 3)))) +
#label=sprintf(“%0.2f”, round(!!rlang::sym(statistic), digits = 2)))) +
ggplot2::geom_bar( stat = “identity”, position = “dodge”, color =
“black”, alpha = 0.7) + ggplot2::facet_wrap(~tissue_name, ncol = 4) +
ggplot2::scale_y_continuous(breaks=c(0, 0.5, 1.00), limits = c(-0.05,
1.1)) + ggplot2::xlab(“Tabula Muris Tissues”) + ggplot2::ylab(y_label) +
ggplot2::ggtitle(y_label) + ggplot2::labs(fill = “Method”) +
#ggplot2::scale_fill_brewer(palette = “Set1”, labels = c(“callback”,
“sc-SHC”, “CHOIR”)) + ggplot2::scale_fill_manual(values = c(“red”,
“grey”, “black”, “tan”), labels = c(“recall+ZIP”, “sc-SHC”, “CHOIR”,
“scAce”)) + ggplot2::theme_bw() + ggplot2::theme(axis.ticks.x =
ggplot2::element_blank(), axis.text.x = ggplot2::element_blank(),
axis.text = ggplot2::element_text(size = small_text_size), axis.title =
ggplot2::element_text(size = large_text_size), strip.text =
ggplot2::element_text(size = small_text_size), legend.text =
ggplot2::element_text(size = small_text_size, family = “Courier”),
legend.title = ggplot2::element_text(size = small_text_size), plot.title
= ggplot2::element_text(size = large_text_size, hjust = 0.5),
legend.position=“bottom”) + ggplot2::geom_text(vjust = -0.2)</p>
<p>return(bar_plot) }</p>
<p>library(ggplot2)
setwd(“/Users/alandenadel/Desktop/callback_review_scripts/tabula_muris_additions”)</p>
<p>cluster_metrics_df &lt;- read.csv(“cluster_metrics_df.csv”, row.names
= 1)</p>
<p>cluster_metrics_copula &lt;-
read.csv(“tabula_muris_copula_additional_clustering_metrics.csv”,
row.names = 1) # one column name had a mismatch
names(cluster_metrics_df)[names(cluster_metrics_df) == ‘ari’] &lt;-
‘ari_results’ cluster_metrics_df &lt;- rbind(cluster_metrics_df,
cluster_metrics_copula)</p>
<p>bar_plot_width &lt;- 2 * 1440 bar_plot_height &lt;- 2.4 * 1440</p>
<p>vmeasure_plot &lt;-
clustering_metrics_facet_plot_with_additions(cluster_metrics_df,
“v_measure_results”, “V-measure”) vmeasure_plot_fig2 &lt;-
clustering_metrics_facet_plot_for_figure2(cluster_metrics_df,
“v_measure_results”, “V-measure”) ggsave(“vmeasure_plot.png”,
vmeasure_plot, width = 2 * bar_plot_width, height = bar_plot_height,
units = ‘px’) ggsave(“fig2_vmeasure_plot.png”, vmeasure_plot_fig2, width
= 2 * 1440, height = bar_plot_height, units = ‘px’)</p>
<p>ari_plot &lt;-
clustering_metrics_facet_plot_with_additions(cluster_metrics_df,
“ari_results”, “ARI”) ari_plot_fig2 &lt;-
clustering_metrics_facet_plot_for_figure2(cluster_metrics_df,
“ari_results”, “ARI”) ggsave(“ari_plot.png”, ari_plot, width = 2 *
bar_plot_width, height = bar_plot_height, units = ‘px’)
ggsave(“fig2_ari_plot.png”, ari_plot_fig2, width = bar_plot_width,
height = bar_plot_height, units = ‘px’)</p>
<p>fm_plot &lt;-
clustering_metrics_facet_plot_with_additions(cluster_metrics_df,
“fowlkes_mallows_results”, “Fowlkes-Mallows Index”)
ggsave(“fm_plot.png”, fm_plot, width = 2 * bar_plot_width, height =
bar_plot_height, units = ‘px’)</p>
<p>homogeneity_plot &lt;-
clustering_metrics_facet_plot_with_additions(cluster_metrics_df,
“homogeneity_results”, “Homogeneity”) ggsave(“homogeneity_plot.png”,
homogeneity_plot, width = 2 * bar_plot_width, height = bar_plot_height,
units = ‘px’)</p>
<p>completeness_plot &lt;-
clustering_metrics_facet_plot_with_additions(cluster_metrics_df,
“completeness_results”, “Completeness”) ggsave(“completeness_plot.png”,
completeness_plot, width = 2 * bar_plot_width, height = bar_plot_height,
units = ‘px’)</p>
<p>jaccard_plot &lt;-
clustering_metrics_facet_plot_with_additions(cluster_metrics_df,
“jaccard_results”, “Jaccard Index”) ggsave(“jaccard_plot.png”,
jaccard_plot, width = 2 * bar_plot_width, height = bar_plot_height,
units = ‘px’)</p>
<div class="section level2">
<h2 id="plot-the-timing-data-and-rename-callback-to-recall">plot the timing data and rename callback to recall<a class="anchor" aria-label="anchor" href="#plot-the-timing-data-and-rename-callback-to-recall"></a>
</h2>
<p>tissue_timing_df &lt;- read.csv(“tissue_timing_df.csv”, row.names =
1)</p>
<p>scAce_timing_df &lt;- read.csv(“scAce_timing.csv”, row.names = 1)</p>
<p>tissue_timing_df &lt;- rbind(tissue_timing_df, scAce_timing_df)</p>
</div>
<div class="section level2">
<h2 id="order-factor-levels">order factor levels<a class="anchor" aria-label="anchor" href="#order-factor-levels"></a>
</h2>
<p>tissue_timing_df<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>e</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>d</mi><mo>&lt;</mo><mo>−</mo><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mi>i</mi><mi>s</mi><mi>s</mi><mi>u</mi><msub><mi>e</mi><mi>t</mi></msub><mi>i</mi><mi>m</mi><mi>i</mi><mi>n</mi><msub><mi>g</mi><mi>d</mi></msub><mi>f</mi></mrow><annotation encoding="application/x-tex">method &lt;- factor(tissue_timing_df</annotation></semantics></math>method,
levels=c(“callback”, “sc-SHC”, “CHOIR”, “scAce”))</p>
</div>
<div class="section level2">
<h2 id="remove-underscores-from-tissue-names">remove underscores from tissue names<a class="anchor" aria-label="anchor" href="#remove-underscores-from-tissue-names"></a>
</h2>
<p>tissue_timing_df<span class="math inline">$tissue &lt;- gsub("_",
"\n", tissue_timing_df$</span>tissue)</p>
<p>small_text_size &lt;- 16 large_text_size &lt;- 22</p>
<p>p &lt;- ggplot2::ggplot(tissue_timing_df, ggplot2::aes(x=method,
y=time, fill=method, label=sprintf(“%0.1f”, round(time, digits = 1)))) +
ggplot2::geom_bar(stat = “identity”, alpha = 0.7, colour = ‘black’) +
ggplot2::facet_wrap(~tissue, nrow = 2) + ggplot2::xlab(“Tabula Muris
Tissues”) + ggplot2::ylab(“Time Taken (minutes)”) + ggplot2::labs(fill =
“Method”) + ggplot2::ylim(c(0,18)) + ggplot2::scale_fill_manual(values =
c(“red”, “grey”, “black”, “tan”), labels = c(“recall+ZIP”, “sc-SHC”,
“CHOIR”, “scAce”)) + ggplot2::theme_bw() + ggplot2::theme(axis.ticks.x =
ggplot2::element_blank(), axis.text.x = ggplot2::element_blank(),
axis.text = ggplot2::element_text(size = small_text_size), axis.title =
ggplot2::element_text(size = large_text_size), strip.text =
ggplot2::element_text(size = small_text_size), legend.text =
ggplot2::element_text(size = small_text_size, family = “Courier”),
legend.title = ggplot2::element_text(size = small_text_size),
legend.position = “bottom”) + geom_text(vjust = -0.2)</p>
<p>ggsave(“fig2_tabula_muris_timing.png”, p, width = 4 * 1440, height =
4 * 460, units = “px”)</p>
</div>
<div class="section level2">
<h2 id="plot-umaps-for-two-tissues">plot UMAPs for two tissues<a class="anchor" aria-label="anchor" href="#plot-umaps-for-two-tissues"></a>
</h2>
<p>diaphragm &lt;- readRDS(file = “Diaphragmcluster_results_seurat.rds”)
limb_muscle &lt;- readRDS(file =
“Limb_Musclecluster_results_seurat.rds”)</p>
<p>diagphragm_scace &lt;-
anndata::read_h5ad(“scace_output/Diaphragm.h5ad”) diagphragm_scace &lt;-
Seurat::CreateSeuratObject(counts =
t(diagphragm_scace<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>g</mi><msub><mi>m</mi><mi>s</mi></msub><mi>c</mi><mi>a</mi><mi>c</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">X), meta.data = diagphragm_scace</annotation></semantics></math>obs)</p>
<p>limb_muscle_scace &lt;-
anndata::read_h5ad(“scace_output/Limb_Muscle.h5ad”) limb_muscle_scace
&lt;- Seurat::CreateSeuratObject(counts =
t(limb_muscle_scace<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>=</mo><mi>l</mi><mi>i</mi><mi>m</mi><msub><mi>b</mi><mi>m</mi></msub><mi>u</mi><mi>s</mi><mi>c</mi><mi>l</mi><msub><mi>e</mi><mi>s</mi></msub><mi>c</mi><mi>a</mi><mi>c</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">X), meta.data = limb_muscle_scace</annotation></semantics></math>obs)</p>
</div>
<div class="section level2">
<h2 id="add-scace-idents-to-seurat-objs">add scAce idents to Seurat objs<a class="anchor" aria-label="anchor" href="#add-scace-idents-to-seurat-objs"></a>
</h2>
<p><a href="mailto:diaphragm@meta.data" class="email">diaphragm@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>c</mi><mi>A</mi><mi>c</mi><msub><mi>e</mi><mi>i</mi></msub><mi>d</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo>&lt;</mo><mo>−</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>g</mi><msub><mi>m</mi><mi>s</mi></msub><mi>c</mi><mi>a</mi><mi>c</mi><mi>e</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">scAce_idents &lt;- diagphragm_scace@meta.data</annotation></semantics></math>scace_cluster
<a href="mailto:limb_muscle@meta.data" class="email">limb_muscle@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>c</mi><mi>A</mi><mi>c</mi><msub><mi>e</mi><mi>i</mi></msub><mi>d</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo>&lt;</mo><mo>−</mo><mi>l</mi><mi>i</mi><mi>m</mi><msub><mi>b</mi><mi>m</mi></msub><mi>u</mi><mi>s</mi><mi>c</mi><mi>l</mi><msub><mi>e</mi><mi>s</mi></msub><mi>c</mi><mi>a</mi><mi>c</mi><mi>e</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">scAce_idents &lt;- limb_muscle_scace@meta.data</annotation></semantics></math>scace_cluster</p>
</div>
<div class="section level2">
<h2 id="remove-nas">remove NAs<a class="anchor" aria-label="anchor" href="#remove-nas"></a>
</h2>
<p>limb_muscle &lt;- subset(limb_muscle, subset = cell_ontology_class
%in% levels(factor(<a href="mailto:limb_muscle@meta.data" class="email">limb_muscle@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>m</mi><mo>&lt;</mo><mo>−</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>t</mi><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>m</mi><mo>,</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>t</mi><mo>=</mo><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cell_ontology_class)))
diaphragm &lt;- subset(diaphragm, subset = cell_ontology_class %in% levels(factor(diaphragm@meta.data</annotation></semantics></math>cell_ontology_class)))</p>
</div>
<div class="section level2">
<h2 id="clean-up-cell-type-labels-for-limb_muscle">clean up cell type labels for limb_muscle<a class="anchor" aria-label="anchor" href="#clean-up-cell-type-labels-for-limb_muscle"></a>
</h2>
<p>#<a href="mailto:limb_muscle@meta.data" class="email">limb_muscle@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="false" form="prefix">[</mo><mi>l</mi><mi>i</mi><mi>m</mi><msub><mi>b</mi><mi>m</mi></msub><mi>u</mi><mi>s</mi><mi>c</mi><mi>l</mi><mi>e</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">cell_ontology_class[limb_muscle@meta.data</annotation></semantics></math>cell_ontology_class
== ““] &lt;-”cardiac neuron” #<a href="mailto:limb_muscle@meta.data" class="email">limb_muscle@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>&lt;</mo><mo>−</mo><mi>t</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>w</mi><mi>s</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>i</mi><mi>m</mi><msub><mi>b</mi><mi>m</mi></msub><mi>u</mi><mi>s</mi><mi>c</mi><mi>l</mi><mi>e</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">cell_ontology_class &lt;- trimws(limb_muscle@meta.data</annotation></semantics></math>cell_ontology_class,
whitespace = ” cell”)</p>
</div>
<div class="section level2">
<h2 id="shorten-cell-type-labels-for-diaphragm">shorten cell type labels for diaphragm<a class="anchor" aria-label="anchor" href="#shorten-cell-type-labels-for-diaphragm"></a>
</h2>
<p>#<a href="mailto:diaphragm@meta.data" class="email">diaphragm@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>&lt;</mo><mo>−</mo><mi>t</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>w</mi><mi>s</mi><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>m</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">cell_ontology_class &lt;- trimws(diaphragm@meta.data</annotation></semantics></math>cell_ontology_class,
whitespace = ” cell”)</p>
</div>
<div class="section level2">
<h2 id="sort-levels-by-size-of-group-limb_muscle">sort levels by size of group (limb_muscle)<a class="anchor" aria-label="anchor" href="#sort-levels-by-size-of-group-limb_muscle"></a>
</h2>
<p><a href="mailto:limb_muscle@meta.data" class="email">limb_muscle@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>&lt;</mo><mo>−</mo><mi>a</mi><mi>s</mi><mi>.</mi><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>i</mi><mi>m</mi><msub><mi>b</mi><mi>m</mi></msub><mi>u</mi><mi>s</mi><mi>c</mi><mi>l</mi><mi>e</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">cell_ontology_class &lt;- as.factor(limb_muscle@meta.data</annotation></semantics></math>cell_ontology_class)
sorted_limb_muscle_clusters &lt;-
names(sort(summary(as.factor(na.omit(<a href="mailto:limb_muscle@meta.data" class="email">limb_muscle@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>=</mo><mi>T</mi><mi>R</mi><mi>U</mi><mi>E</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mi>l</mi><mi>i</mi><mi>m</mi><msub><mi>b</mi><mi>m</mi></msub><mi>u</mi><mi>s</mi><mi>c</mi><mi>l</mi><mi>e</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">cell_ontology_class))), decreasing = TRUE))
limb_muscle@meta.data</annotation></semantics></math>cell_ontology_class
&lt;- factor(<a href="mailto:limb_muscle@meta.data" class="email">limb_muscle@meta.data</a>$cell_ontology_class, levels =
sorted_limb_muscle_clusters)</p>
</div>
<div class="section level2">
<h2 id="sort-levels-by-size-of-group-diaphragm">sort levels by size of group (diaphragm)<a class="anchor" aria-label="anchor" href="#sort-levels-by-size-of-group-diaphragm"></a>
</h2>
<p><a href="mailto:diaphragm@meta.data" class="email">diaphragm@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>&lt;</mo><mo>−</mo><mi>a</mi><mi>s</mi><mi>.</mi><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>m</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">cell_ontology_class &lt;- as.factor(diaphragm@meta.data</annotation></semantics></math>cell_ontology_class)
sorted_diaphragm_clusters &lt;- names(sort(summary(as.factor(na.omit(<a href="mailto:diaphragm@meta.data" class="email">diaphragm@meta.data</a><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>o</mi></msub><mi>n</mi><mi>t</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>=</mo><mi>T</mi><mi>R</mi><mi>U</mi><mi>E</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>m</mi><mi>@</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">cell_ontology_class))), decreasing = TRUE))
diaphragm@meta.data</annotation></semantics></math>cell_ontology_class
&lt;- factor(<a href="mailto:diaphragm@meta.data" class="email">diaphragm@meta.data</a>$cell_ontology_class, levels =
sorted_diaphragm_clusters)</p>
<p>library(callbackreproducibility) library(Seurat) library(ggplot2)
library(patchwork) library(grid)</p>
<p>y_limits &lt;- c(-30, 12) x_limits &lt;- c(-20, 20) legend_location
&lt;- c(0.1, 0.2)</p>
<p>tissue &lt;- limb_muscle limb_muscle_curated_scatter &lt;-
custom_scatter(tissue, reduction = “umap”, group_by =
“cell_ontology_class”, x_title = “UMAP 1”, y_title = “UMAP 2”, pt.size =
4) + theme(legend.position = legend_location) +
guides(color=guide_legend(ncol=2)) + xlim(x_limits) + ylim(y_limits) +
scale_colour_discrete(labels = function(x) stringr::str_wrap(x, width =
15))</p>
<p>limb_muscle_default_scatter &lt;- custom_scatter(tissue, reduction =
“umap”, group_by = “seurat_clusters”, x_title = “UMAP 1”, y_title =
“UMAP 2”, pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)
limb_muscle_callback_scatter &lt;- custom_scatter(tissue, reduction =
“umap”, group_by = “callback_idents”, x_title = “UMAP 1”, y_title =
“UMAP 2”, pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)
limb_muscle_scSHC_scatter &lt;- custom_scatter(tissue, reduction =
“umap”, group_by = “scSHC_clusters”, x_title = “UMAP 1”, y_title = “UMAP
2”, pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)
limb_muscle_CHOIR_scatter &lt;- custom_scatter(tissue, reduction =
“umap”, group_by = “CHOIR_clusters_0.05”, x_title = “UMAP 1”, y_title =
“UMAP 2”, pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)
limb_muscle_scAce_scatter &lt;- custom_scatter(tissue, reduction =
“umap”, group_by = “scAce_idents”, x_title = “UMAP 1”, y_title = “UMAP
2”, pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)</p>
<p>tissue &lt;- diaphragm diaphragm_curated_scatter &lt;-
custom_scatter(tissue, reduction = “umap”, group_by =
“cell_ontology_class”, x_title = “UMAP 1”, y_title = “UMAP 2”, pt.size =
4) + theme(legend.position = legend_location) +
guides(color=guide_legend(ncol=2)) + xlim(x_limits) + ylim(y_limits) +
scale_colour_discrete(labels = function(x) stringr::str_wrap(x, width =
15))</p>
<p>diaphragm_default_scatter &lt;- custom_scatter(tissue, reduction =
“umap”, group_by = “seurat_clusters”, x_title = “UMAP 1”, y_title =
“UMAP 2”, pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)
diaphragm_callback_scatter &lt;- custom_scatter(tissue, reduction =
“umap”, group_by = “callback_idents”, x_title = “UMAP 1”, y_title =
“UMAP 2”, pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)
diaphragm_scSHC_scatter &lt;- custom_scatter(tissue, reduction = “umap”,
group_by = “scSHC_clusters”, x_title = “UMAP 1”, y_title = “UMAP 2”,
pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)
diaphragm_CHOIR_scatter &lt;- custom_scatter(tissue, reduction = “umap”,
group_by = “CHOIR_clusters_0.05”, x_title = “UMAP 1”, y_title = “UMAP
2”, pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)
diaphragm_scAce_scatter &lt;- custom_scatter(tissue, reduction = “umap”,
group_by = “scAce_idents”, x_title = “UMAP 1”, y_title = “UMAP 2”,
pt.size = 4) + NoLegend() + xlim(x_limits) + ylim(y_limits)</p>
<p>row_label_1 &lt;- wrap_elements(panel = textGrob(‘Diaphragm’, gp =
gpar(fontsize = 64), rot = 90)) row_label_2 &lt;- wrap_elements(panel =
textGrob(‘Limb Muscle’, gp = gpar(fontsize = 64), rot = 90))</p>
<p>column_label_1 &lt;- wrap_elements(panel = textGrob(‘Curated Labels’,
gp = gpar(fontsize = 64))) column_label_2 &lt;- wrap_elements(panel =
textGrob(‘recall+ZIP’, gp = gpar(fontsize = 64, fontfamily =
“Courier”))) column_label_3 &lt;- wrap_elements(panel =
textGrob(‘sc-SHC’, gp = gpar(fontsize = 64, fontfamily = “Courier”)))
column_label_4 &lt;- wrap_elements(panel = textGrob(‘CHOIR’, gp =
gpar(fontsize = 64, fontfamily = “Courier”))) column_label_5 &lt;-
wrap_elements(panel = textGrob(‘scAce’, gp = gpar(fontsize = 64,
fontfamily = “Courier”)))</p>
<p>patchwork_grid &lt;- plot_spacer() + column_label_1 + column_label_2
+ column_label_3 + column_label_4 + column_label_5 + row_label_1 +
diaphragm_curated_scatter + diaphragm_callback_scatter +
diaphragm_scSHC_scatter + diaphragm_CHOIR_scatter +
diaphragm_scAce_scatter + plot_spacer() + column_label_1 +
column_label_2 + column_label_3 + column_label_4 + column_label_5 +
row_label_2 + limb_muscle_curated_scatter + limb_muscle_callback_scatter
+ limb_muscle_scSHC_scatter + limb_muscle_CHOIR_scatter +
limb_muscle_scAce_scatter + plot_layout(widths = c(1, 5, 5, 5, 5, 5),
heights = c(1,3,1,3))</p>
<p>ggsave(“fig2_umap_grid.png”, patchwork_grid, width = 1.8 * 2^13,
height = 0.8 * 2^13, units = “px”)</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alan DenAdel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
